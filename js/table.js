//Индексы в массиве
let indexes = {
    "distance": 0,
    "scope": 1,
    "elev_correction": 2,
    "time_of_flight_100m": 3,
    "time_of_flight": 4,
    "wind_correction": 5,
    "range_wind_1": 6,
    "range_wind_2": 7,
    "temp_correction": 8,
    "pressure_correction": 9,
    "air_destiny_1": 10,
    "air_destiny_2": 11,
};

function getMean(arr1, arr2) {
    let array = [];
    for (let i = 0; i<arr1.length; i++)
    {
        let item = (parseFloat(arr1[i]) + parseFloat(arr2[i])) / 2;
        array.push(item);
    }
    return array;
}

//Преобразует массив поправок в ассоциативный массив
function reformatArray(range_array) {
    let arr = {};
    for (let i in indexes)
    {
        arr[i] = range_array[indexes[i]];
    }
    return arr;
}

//Находит ближайший массив поправок.
function findNearestRangeValue(cannon_type, ammo_name, range) {
    let range_array = [];
    switch (cannon_type){
        case "2b14":
            range_array = get2b14ammoTables(ammo_name);
            break;
        default:
            return false;
    }

    let y0 = parseInt(range_array[0][indexes["distance"]]);
    for (let i = 1; i < range_array.length; i++)
    {
        let y1 = parseInt(range_array[i][indexes["distance"]]);

        if (range === y0)
            return range_array[i-1];

        if (range === y1)
            return range_array[i];

        if (y0 < range && range < y1) {
            return getMean(range_array[i - 1], range_array[i]);
        }

        y0 = y1;
    }

    return false;
}

function get2b14ammoTables(ammo_name) {
    let first = [["250","333","2","0.8","25.2","8.5","2.5","-2.3","1.7","0.3","-0.3","0.3"],
        ["300","347","3","0.8","25.1","7.4","2.6","-2.3","1.9","0.4","-0.4","0.4"],
        ["350","363","4","0.8","25.1","6.4","2.6","-2.4","2.3","0.5","-0.5","0.5"],
        ["400","379","4","0.8","25.0","5.6","2.7","-2.4","2.6","0.5","-0.5","0.5"],
        ["450","396","4","0.8","25.0","5.1","2.8","-2.5","2.9","0.6","-0.6","0.6"],
        ["500","414","6","0.9","24.9","4.5","2.8","-2.5","3.3","0.7","-0.7","0.7"],
        ["550","431","6","0.9","24.8","4.1","2.9","-2.6","3.6","0.7","-0.8","0.7"],
        ["600","449","7","0.9","24.7","3.8","3.0","-2.6","3.9","0.8","-0.8","0.8"],
        ["650","467","7","0.9","24.6","3.5","3.0","-2.7","4.3","0.9","-0.9","0.9"],
        ["700","484","8","0.9","24.5","3.3","3.1","-2.7","4.6","1.0","-1.0","0.9"],
        ["750","503","8","0.9","24.4","3.1","3.2","-2.8","4.9","1.0","-1.0","1.0"],
        ["800","523","9","0.9","24.3","2.9","3.3","-2.9","5.3","1.1","-1.1","1.1"],
        ["850","542","10","0.9","24.1","2.7","3.3","-2.9","5.6","1.2","-1.2","1.2"],
        ["900","562","11","1.0","23.9","2.5","3.4","-3.0","6.0","1.3","-1.3","1.2"],
        ["950","583","12","1.0","23.8","2.4","3.5","-3.1","6.3","1.3","-1.3","1.3"],
        ["1000","605","14","1.0","23.6","2.3","3.5","-3.1","6.7","1.4","-1.4","1.4"],
        ["1050","628","16","1.0","23.3","2.2","3.6","-3.2","7.0","1.5","-1.5","1.4"],
        ["1100","651","17","1.1","23.1","2.1","3.7","-3.3","7.4","1.5","-1.6","1.5"],
        ["1150","677","20","1.1","22.8","2.0","3.7","-3.3","7.7","1.6","-1.6","1.6"],
        ["1200","704","23","1.2","22.5","1.9","3.8","-3.4","8.1","1.7","-1.7","1.7"],
        ["1250","733","25","1.2","22.1","1.8","3.8","-3.4","8.4","1.8","-1.8","1.7"],
        ["1300","766","31","1.3","21.7","1.7","3.8","-3.5","8.7","1.8","-1.9","1.8"],
        ["1350","802","38","1.5","21.2","1.6","3.8","-3.5","9.0","1.9","-1.9","1.9"],
        ["1400","845","47","1.6","20.6","1.5","3.8","-3.5","9.3","2.0","-2.0","1.9"],
        ["1450","904","68","2.0","19.7","1.3","3.7","-3.4","9.6","2.0","-2.0","2.0"]];

    let second = [["400","333","2","0.7","32.0","10.8","4.9","-4.6","3.6","-0.8","-0.8","0.8"],
        ["450","343","2","0.7","31.9","9.8","5.0","-4.7","4.0","0.9","-0.9","0.9"],
        ["500","353","2","0.7","31.9","8.8","5.0","-4.7","4.4","1.0","-1.0","1.0"],
        ["550","363","2","0.7","31.9","8.1","5.1","-4.7","4.9","1.1","-1.1","1.1"],
        ["600","375","3","0.7","31.8","7.3","5.2","-4.8","5.4","1.2","-1.2","1.2"],
        ["650","385","3","0.7","31.8","6.8","5.2","-4.9","5.8","1.3","-1.4","1.3"],
        ["700","395","3","0.7","31.7","6.4","5.3","-4.9","6.2","1.4","-1.5","1.4"],
        ["750","407","3","0.7","31.7","5.9","5.4","-5.0","6.7","1.5","-1.6","1.5"],
        ["800","418","4","0.7","31.6","5.5","5.5","-5.0","7.2","1.7","-1.7","1.6"],
        ["850","429","4","0.7","31.5","5.3","5.5","-5.1","7.7","1.8","-1.8","1.7"],
        ["900","440","4","0.7","31.4","5.0","5.6","-5.2","8.1","1.9","-1.9","1.8"],
        ["950","452","4","0.7","31.4","4.7","5.7","-5.2","8.6","2.0","-2.0","1.9"],
        ["1000","463","5","0.7","31.3","4.5","5.8","-5.3","9.0","2.1","-2.1","2.0"],
        ["1050","474","5","0.7","31.2","4.3","5.9","-5.4","9.5","2.2","-2.2","2.1"],
        ["1100","486","5","0.7","31.1","4.1","5.9","-5.4","10.0","2.3","-2.3","2.2"],
        ["1150","498","5","0.7","31.0","3.9","6.0","-5.5","10.5","2.4","-2.4","2.3"],
        ["1200","511","6","0.7","30.9","3.8","6.1","-5.6","10.9","2.5","-2.6","2.4"],
        ["1250","523","6","0.8","30.8","3.6","6.2","-5.7","11.4","2.6","-2.7","2.5"],
        ["1300","535","6","0.8","30.7","3.5","6.3","-5.7","11.9","2.7","-2.8","2.6"],
        ["1350","548","7","0.8","30.5","3.4","6.3","-5.8","12.3","2.9","-2.9","2.8"],
        ["1400","561","7","0.8","30.4","3.2","6.4","-5.9","12.8","3.0","-3.0","2.9"],
        ["1450","574","8","0.8","30.3","3.1","6.5","-6.0","13.3","3.1","-3.1","3.0"],
        ["1500","588","8","0.8","30.1","3.0","6.6","-6.0","13.8","3.2","-3.2","3.1"],
        ["1550","603","8","0.8","29.9","2.9","6.6","-6.1","14.2","3.3","-3.3","3.2"],
        ["1600","617","8","0.8","29.8","2.8","6.7","-6.2","14.7","3.4","-3.5","3.3"],
        ["1650","632","9","0.8","29.6","2.7","6.8","-6.3","15.2","3.5","-3.6","3.4"],
        ["1700","648","11","0.9","29.4","2.6","6.8","-6.3","15.7","3.7","-3.7","3.5"],
        ["1750","663","12","0.9","29.2","2.5","6.9","-6.4","16.2","3.8","-3.8","3.6"],
        ["1800","679","12","0.9","28.9","2.4","6.9","-6.5","16.6","3.9","-3.9","3.7"],
        ["1850","697","14","0.9","28.7","2.3","7.0","-6.5","17.1","4.0","-4.0","3.8"],
        ["1900","715","15","1.0","28.4","2.3","7.0","-6.6","17.5","4.1","-4.1","3.9"],
        ["1950","734","16","1.0","28.1","2.3","7.1","-6.6","18.0","4.2","-4.2","4.0"],
        ["2000","754","18","1.0","27.8","2.2","7.1","-6.6","18.5","4.3","-4.3","4.1"],
        ["2050","776","20","1.1","27.4","2.1","7.1","-6.7","18.9","4.4","-4.4","4.2"],
        ["2100","800","23","1.2","27.0","2.0","7.1","-6.7","19.3","4.5","-4.5","4.3"],
        ["2150","827","27","1.3","26.5","1.9","7.1","-6.7","19.7","4.6","-4.6","4.4"],
        ["2200","857","33","1.4","26.0","1.8","7.0","-6.7","20.1","4.7","-4.7","4.5"],
        ["2250","892","40","1.6","25.3","1.7","7.0","-6.6","20.4","4.7","-4.8","4.6"],
        ["2300","942","58","2.0","24.2","1.6","6.8","-6.4","20.6","4.8","-4.8","4.6"]];

    let third = [["550","334","1","0.6","37.4","12.4","7.6","-7.2","6.0","1.5","-1.5","1.4"],
        ["600","343","1","0.6","37.4","11.3","7.7","-7.3","6.6","1.6","-1.6","1.5"],
        ["650","350","1","0.6","37.4","10.5","7.7","-7.3","7.2","1.7","-1.8","1.7"],
        ["700","359","2","0.6","37.3","9.8","7.8","-7.4","7.8","1.9","-1.9","1.8"],
        ["750","366","2","0.6","37.3","9.1","7.9","-7.4","8.3","2.0","-2.0","1.9"],
        ["800","375","2","0.6","37.2","8.5","7.9","-7.5","8.9","2.2","-2.2","2.1"],
        ["850","382","2","0.6","37.2","8.1","8.0","-7.5","9.4","2.3","-2.3","2.2"],
        ["900","391","2","0.6","37.2","7.6","8.1","-7.6","10.0","2.4","-2.5","2.3"],
        ["950","398","2","0.6","37.1","7.3","8.1","-7.7","10.5","2.6","-2.6","2.4"],
        ["1000","407","2","0.6","37.1","6.9","8.2","-7.7","11.1","2.7","-2.7","2.6"],
        ["1050","415","2","0.6","37.0","6.6","8.3","-7.8","11.7","2.8","-2.9","2.7"],
        ["1100","423","3","0.6","36.9","6.3","8.4","-7.9","12.3","3.0","-3.0","2.8"],
        ["1150","432","3","0.6","36.9","6.0","8.5","-7.9","12.8","3.1","-3.2","3.0"],
        ["1200","440","3","0.6","36.8","5.8","8.5","-8.0","13.4","3.3","-3.3","3.1"],
        ["1250","449","3","0.6","36.8","5.5","8.6","-8.1","14.0","3.4","-3.4","3.2"],
        ["1300","457","3","0.6","36.7","5.3","8.7","-8.2","14.5","3.5","-3.6","3.4"],
        ["1350","466","3","0.6","36.6","5.2","8.8","-8.2","15.1","3.7","-3.7","3.5"],
        ["1400","475","4","0.6","36.5","5.0","8.9","-8.3","15.7","3.8","-3.9","3.6"],
        ["1450","483","4","0.6","36.5","4.8","8.9","-8.4","16.3","4.0","-4.0","3.8"],
        ["1500","493","4","0.6","36.4","4.6","9.0","-8.5","16.9","4.1","-4.2","3.9"],
        ["1550","502","4","0.6","36.3","4.5","9.1","-8.5","17.5","4.3","-4.3","4.1"],
        ["1600","511","4","0.7","36.2","4.3","9.2","-8.6","18.0","4.4","-4.4","4.2"],
        ["1650","520","4","0.7","36.1","4.2","9.3","-8.7","18.6","4.5","-4.6","4.3"],
        ["1700","529","5","0.7","36.0","4.1","9.3","-8.8","19.2","4.7","-4.7","4.5"],
        ["1750","540","5","0.7","35.9","3.9","9.4","-8.9","19.8","4.8","-4.9","4.6"],
        ["1800","549","5","0.7","35.8","3.8","9.5","-8.9","20.4","5.0","-5.0","4.7"],
        ["1850","559","6","0.7","35.6","3.8","9.6","-9.0","21.0","5.1","-5.2","4.9"],
        ["1900","569","6","0.7","35.5","3.7","9.7","-9.1","21.5","5.3","-5.3","5.0"],
        ["1950","579","6","0.7","35.4","3.6","9.7","-9.2","22.1","5.4","-5.5","5.1"],
        ["2000","589","6","0.7","35.3","3.5","9.8","-9.2","22.7","5.6","-5.6","5.3"],
        ["2050","601","7","0.7","35.1","3.4","9.9","-9.3","23.3","5.7","-5.8","5.4"],
        ["2100","611","7","0.7","35.0","3.3","9.9","-9.4","23.9","5.8","-5.9","5.6"],
        ["2150","622","7","0.7","34.8","3.2","10.0","-9.5","24.4","6.0","-6.1","5.7"],
        ["2200","633","7","0.7","34.6","3.1","10.1","-9.5","25.0","6.1","-6.2","5.8"],
        ["2250","645","8","0.8","34.5","3.0","10.1","-9.6","25.6","6.3","-6.3","6.0"],
        ["2300","657","8","0.8","34.3","3.0","10.2","-9.7","26.2","6.4","-6.5","6.1"],
        ["2350","669","8","0.8","34.1","2.9","10.3","-9.7","26.8","6.6","-6.6","6.2"],
        ["2400","682","9","0.8","33.9","2.8","10.3","-9.8","27.4","6.7","-6.8","6.4"],
        ["2450","695","10","0.8","33.6","2.7","10.4","-9.8","27.9","6.9","-6.9","6.5"],
        ["2500","708","10","0.8","33.4","2.7","10.4","-9.9","28.5","7.0","-7.1","6.6"],
        ["2550","723","11","0.9","33.2","2.6","10.4","-9.9","29.0","7.1","-7.2","6.8"],
        ["2600","737","11","0.9","32.9","2.5","10.5","-10.0","29.6","7.3","-7.3","6.9"],
        ["2650","753","13","0.9","32.6","2.4","10.5","-10.0","30.1","7.4","-7.5","7.0"],
        ["2700","768","14","0.9","32.3","2.4","10.5","-10.0","30.7","7.5","-7.6","7.1"],
        ["2750","785","16","1.0","32.0","2.3","10.5","-10.1","31.2","7.7","-7.7","7.3"],
        ["2800","803","17","1.0","31.6","2.3","10.5","-10.1","31.7","7.8","-7.9","7.4"],
        ["2850","823","19","1.1","31.2","2.2","10.5","-10.1","32.2","7.9","-8.0","7.5"],
        ["2900","844","22","1.2","30.7","2.2","10.4","-10.0","32.7","8.0","-8.1","7.6"],
        ["2950","868","25","1.3","30.2","2.1","10.4","-10.0","33.1","8.1","-8.2","7.7"],
        ["3000","895","30","1.4","29.6","2.0","10.3","-9.9","33.5","8.2","-8.3","7.8"],
        ["3050","929","38","1.7","28.8","1.9","10.1","-9.7","33.8","8.2","-8.3","7.8"],
        ["3100","978","58","2.2","27.5","1.7","9.8","-9.4","33.9","8.2","-8.3","7.8"]];

    let main = [["100","338","5","1.3","15.0","5.0","0.6","-0.5","0.3","0.0","-0.0","0.0"],
        ["150","383","10","1.3","14.9","3.4","0.6","-0.5","0.5","0.1","-0.1","0.1"],
        ["200","430","15","1.3","14.8","2.5","0.7","-0.5","0.7","0.1","-0.1","0.1"],
        ["250","478","19","1.4","14.6","2.1","0.7","-0.6","0.9","0.1","-0.1","0.1"],
        ["300","529","25","1.4","14.4","1.7","0.8","-0.6","1.1","0.2","-0.2","0.2"],
        ["350","585","33","1.5","14.1","1.5","0.8","-0.7","1.3","0.2","-0.2","0.2"],
        ["400","646","42","1.6","13.8","1.3","0.9","-0.7","1.5","0.2","-0.2","0.2"],
        ["450","718","58","1.8","13.3","1.1","0.9","-0.7","1.6","0.2","-0.2","0.2"],
        ["500","811","87","2.1","12.5","0.9","0.9","-0.8","1.8","0.3","-0.3","0.3"]];

    let long = [["700","335","1","0.5","42.7","14.0","10.8","-10.4","9.2","2.3","-2.4","2.2"],
        ["750","342","1","0.5","42.7","12.9","10.9","-10.5","9.9","2.5","-2.5","2.4"],
        ["800","348","1","0.5","42.7","12.3","11.0","-10.5","10.5","2.7","-2.7","2.5"],
        ["850","354","1","0.5","42.6","11.5","11.0","-10.6","11.2","2.8","-2.9","2.7"],
        ["900","361","1","0.5","42.6","10.9","11.1","-10.6","11.9","3.0","-3.0","2.8"],
        ["950","366","1","0.5","42.6","10.4","11.2","-10.7","12.5","3.2","-3.2","3.0"],
        ["1000","373","1","0.5","42.5","9.8","11.2","-10.8","13.2","3.3","-3.4","3.1"],
        ["1050","379","1","0.6","42.5","9.4","11.3","-10.8","13.9","3.5","-3.6","3.3"],
        ["1100","386","1","0.6","42.4","8.9","11.4","-10.9","14.6","3.7","-3.7","3.5"],
        ["1150","392","1","0.5","42.4","8.6","11.4","-10.9","15.2","3.8","-3.9","3.6"],
        ["1200","398","1","0.5","42.4","8.3","11.5","-11.0","15.9","4.0","-4.1","3.8"],
        ["1250","405","1","0.6","42.3","8.0","11.6","-11.1","16.5","4.2","-4.2","3.9"],
        ["1300","411","1","0.6","42.3","7.6","11.7","-11.1","17.2","4.4","-4.4","4.1"],
        ["1350","418","2","0.6","42.2","7.3","11.8","-11.2","17.9","4.5","-4.6","4.3"],
        ["1400","424","2","0.6","42.2","7.1","11.8","-11.3","18.6","4.7","-4.8","4.4"],
        ["1450","431","2","0.6","42.1","6.8","11.9","-11.4","19.2","4.9","-4.9","4.6"],
        ["1500","438","2","0.6","42.1","6.6","12.0","-11.4","20.0","5.1","-5.1","4.8"],
        ["1550","445","2","0.6","42.0","6.4","12.1","-11.5","20.7","5.2","-5.3","4.9"],
        ["1600","452","2","0.6","41.9","6.2","12.1","-11.6","21.3","5.4","-5.5","5.1"],
        ["1650","458","2","0.6","41.9","6.0","12.2","-11.7","22.0","5.6","-5.6","5.2"],
        ["1700","466","2","0.6","41.8","5.8","12.3","-11.7","22.7","5.8","-5.8","5.4"],
        ["1750","472","2","0.6","41.7","5.7","12.4","-11.8","23.4","5.9","-6.0","5.6"],
        ["1800","480","3","0.6","41.7","5.5","12.5","-11.9","24.1","6.1","-6.2","5.7"],
        ["1850","486","3","0.6","41.6","5.3","12.5","-12.0","24.7","6.3","-6.3","5.9"],
        ["1900","494","3","0.6","41.5","5.3","12.6","-12.0","25.4","6.5","-6.5","6.1"],
        ["1950","501","3","0.6","41.4","5.1","12.7","-12.1","26.2","6.6","-6.7","6.2"],
        ["2000","509","3","0.6","41.3","5.0","12.8","-12.2","26.9","6.8","-6.9","6.4"],
        ["2050","515","3","0.6","41.3","4.9","12.9","-12.3","27.5","7.0","-7.1","6.5"],
        ["2100","523","3","0.6","41.2","4.8","12.9","-12.4","28.2","7.2","-7.2","6.7"],
        ["2150","530","3","0.6","41.1","4.6","13.0","-12.4","28.8","7.3","-7.4","6.9"],
        ["2200","539","4","0.6","41.0","4.5","13.1","-12.5","29.6","7.5","-7.6","7.1"],
        ["2250","546","4","0.6","40.9","4.4","13.2","-12.6","30.3","7.7","-7.8","7.2"],
        ["2300","554","4","0.6","40.8","4.3","13.3","-12.7","30.9","7.9","-8.0","7.4"],
        ["2350","562","4","0.6","40.6","4.2","13.3","-12.7","31.7","8.1","-8.1","7.5"],
        ["2400","570","4","0.6","40.5","4.1","13.4","-12.8","32.3","8.2","-8.3","7.7"],
        ["2450","578","5","0.6","40.4","4.0","13.5","-12.9","33.0","8.4","-8.5","7.9"],
        ["2500","587","5","0.6","40.3","3.9","13.5","-13.0","33.7","8.6","-8.7","8.0"],
        ["2550","595","5","0.6","40.2","3.8","13.6","-13.0","34.4","8.8","-8.9","8.2"],
        ["2600","603","5","0.6","40.0","3.8","13.7","-13.1","35.1","8.9","-9.0","8.4"],
        ["2650","612","5","0.6","39.9","3.8","13.8","-13.2","35.8","9.1","-9.2","8.5"],
        ["2700","620","5","0.6","39.8","3.7","13.8","-13.3","36.4","9.3","-9.4","8.7"],
        ["2750","630","6","0.7","39.6","3.6","13.9","-13.3","37.2","9.5","-9.6","8.9"],
        ["2800","638","6","0.7","39.5","3.5","13.9","-13.4","37.8","9.6","-9.7","9.0"],
        ["2850","648","6","0.7","39.3","3.5","14.0","-13.5","38.5","9.8","-9.9","9.2"],
        ["2900","657","6","0.7","39.1","3.4","14.0","-13.5","39.1","10.0","-10.1","9.3"],
        ["2950","667","7","0.7","39.0","3.3","14.1","-13.6","39.9","10.2","-10.3","9.5"],
        ["3000","677","7","0.7","38.8","3.2","14.1","-13.6","40.5","10.3","-10.4","9.7"],
        ["3050","687","7","0.7","38.6","3.2","14.2","-13.7","41.2","10.5","-10.6","9.8"],
        ["3100","697","7","0.7","38.4","3.1","14.2","-13.7","41.8","10.7","-10.8","10.0"],
        ["3150","708","8","0.7","38.2","3.0","14.3","-13.8","42.5","10.8","-10.9","10.1"],
        ["3200","719","8","0.7","38.0","3.0","14.3","-13.8","43.2","11.0","-11.1","10.3"],
        ["3250","731","8","0.8","37.7","2.9","14.3","-13.9","43.9","11.2","-11.3","10.4"],
        ["3300","742","9","0.8","37.5","2.8","14.4","-13.9","44.5","11.3","-11.4","10.6"],
        ["3350","754","9","0.8","37.2","2.8","14.4","-13.9","45.1","11.5","-11.6","10.7"],
        ["3400","768","10","0.8","36.9","2.7","14.4","-13.9","45.8","11.7","-11.8","10.9"],
        ["3450","781","11","0.9","36.6","2.6","14.4","-13.9","46.4","11.8","-11.9","11.0"],
        ["3500","794","11","0.9","36.3","2.6","14.4","-13.9","47.0","12.0","-12.1","11.2"],
        ["3550","809","13","0.9","36.0","2.5","14.4","-13.9","47.6","12.1","-12.2","11.3"],
        ["3600","824","14","1.0","35.6","2.4","14.3","-13.9","48.1","12.2","-12.4","11.5"],
        ["3650","841","16","1.0","35.2","2.4","14.3","-13.9","48.7","12.4","-12.5","11.6"],
        ["3700","858","18","1.1","34.8","2.3","14.2","-13.8","49.2","12.5","-12.6","11.7"],
        ["3750","878","20","1.1","34.3","2.3","14.1","-13.8","49.8","12.6","-12.8","11.8"],
        ["3800","900","23","1.2","33.7","2.2","14.0","-13.7","50.2","12.7","-12.9","11.9"],
        ["3850","925","27","1.4","33.0","2.2","13.8","-13.5","50.6","12.8","-13.0","12.0"],
        ["3900","957","36","1.7","32.1","2.1","13.6","-13.3","50.8","12.9","-13.0","12.1"]];

    let array = {
        "main": main,
        "first": first,
        "second": second,
        "third": third,
        "long": long
    };

    return array[ammo_name];
}
